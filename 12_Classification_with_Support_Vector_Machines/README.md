# 12. Classification with Support Vector Machines

### support vector machine (SVM) 이란?
- 다양한 데이터 분포에서도 잘 작동하는 분류 기법 중 최상의 기법으로 널리 사용되고 있다.
- N 차원의 공간을 (N-1) 차원으로 나누는 최적의 초평면, 즉 최대 마진이 되도록 클래스를 분류하는 기법
  <img width="558" alt="스크린샷 2024-08-28 오후 8 40 36" src="https://github.com/user-attachments/assets/c96e88df-9cc7-4ccf-ac4f-61687df15ed3">



### Hyperplane(초평면)
- 최대 마진 분류기는 각 관찰 값들을 선형 경계로 구별하는 방법으로, 직관적으로 이해하고 설명하기 쉽다.
- 최대 마진 분류기가 선형 경계로 사용하는 선을 초평면이라고 하는데, 데이터가 n 차원이라면 초평면은 n-1 차원을 가진다.
  <img width="509" alt="스크린샷 2024-08-28 오후 8 26 48" src="https://github.com/user-attachments/assets/07ce78a0-b587-4a0e-8978-c3a4712b2956">

- 초평면은 n 차원의 공간을 두 개의 부분으로 이등분한다.
  
### 분리 초평변 (Seperating Hyperplane)
- 훈련 관측치들을 클래스 라벨에 따라 완벽하게 분리해내는 초평면이 존재한다고 가정해보자. 그럼 아래와 같은 그림이 나타날 것이다.
  <img width="254" alt="스크린샷 2024-08-28 오후 8 28 59" src="https://github.com/user-attachments/assets/cd32f209-5ee4-4a2d-830b-2b9f1e218b8f">

- 즉, 분리가 가능한 초평면이 하나가 아닌 여러 개가 존재하는 경우다.
- 이렇게 관측치들을 클래스 라벨에 따라 완벽하게 분리하는 초평면들을 분리 초평면이라고 한다.
- 여기서 해결해야 할 문제는 **최적의 분리 초평면을 선택하는 것**이다.

### 최대 마진 분류기 (Maximal Margin Classifier)
#### 마진
- 클래스들 사이의 간격, 각 클래스 말단에 위치한 데이터들 사이의 거리
- 최적 마진 초평면은 **분리 초평면으로부터 마진이 가장 큰 것**
  - 이는 곧 해당 초평면이 관측치를 잘 분류함을 나타낸다.
<img width="397" alt="image" src="https://github.com/user-attachments/assets/c00058b3-966d-4dd7-a99c-593f2c19374e">

- 위 그림에서 검정 관측치가 이 최대 마진 초평면의 어느 쪽에 놓이는지를 기반으로 분류하는데, 이것을 최대 마진 분류기라고 한다.
- 점선에 걸쳐있는 관측값들을 서포트 벡터라고 하는데, 이 관측치들이 약간 이동되면 최대 마진 초평면도 이동될 것이라는 의미에서 최대 마진 초평면을 "서포트"하기 때문에 붙여진 이름
- 최대 마진 분류기는 분리 초평면이 존재한다면 좋은 방법이지만, 어떤 데이터의 경우 초평면이 존재하지 않을 수 있고, 따라서 최대 마진 분류기 또한 존재할 수 없다.
- 이를 해결하기 위해 사용하는 것이 서포트 벡터 분류기다.



### 서포트 벡터 분류기
- 최대 마진 분류기를 확장한 개념으로 몇몇 훈련 관측치들을 잘못 분류하더라도 나머지 관측치들을 더 잘 분류할 수 있는 방법
- 모든 관측치가 초평면 뿐만 아니라 마진의 올바른 쪽에 있도록 가능한 한 가장 큰 마진을 찾는 대신에, 일부 관측치들은 옳지 않은 쪽에 있거나 심지어는 초평면의 옳지 않은 쪽에 있도록 허용된다.


### 서포트 벡터 머신
- 서포트 벡터 분류기를 확장하여 비선형의 클래스 경제를 수용하는 분류 방법 중 하나
- 즉, 선형 분류기를 비선형 구조로 변경해서 관측값들을 분류하는 것
- 아래 그림을 보면 데이터들이 비선형 구조를 가지고 있기에 선형 분류기로는 분류가 불가능함을 알 수 있다.
  <img width="558" alt="스크린샷 2024-08-28 오후 8 40 36" src="https://github.com/user-attachments/assets/c96e88df-9cc7-4ccf-ac4f-61687df15ed3">
- SVM은 커널(Kernels)을 사용해서 특정한 방식으로 변수 공간을 확장한 결과이다.
  - 커널은 클래스들 사이의 비선형 경계를 수용하기 위해 변수공간을 확장하고자할 때 사용하는 계산기법이다.

## 참고자료
- https://blog.naver.com/tjdudwo93/221051481147
- https://m.blog.naver.com/winddori2002/221662413641
- https://sanghyu.tistory.com/7
